# é¢˜ç›®

[196. åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±](https://leetcode.cn/problems/delete-duplicate-emails/)

è¡¨: `Person`

```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| email       | varchar |
+-------------+---------+
id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€å°ç”µå­é‚®ä»¶ã€‚ç”µå­é‚®ä»¶å°†ä¸åŒ…å«å¤§å†™å­—æ¯ã€‚
```

ç¼–å†™è§£å†³æ–¹æ¡ˆ **åˆ é™¤** æ‰€æœ‰é‡å¤çš„ç”µå­é‚®ä»¶ï¼Œåªä¿ç•™ä¸€ä¸ªå…·æœ‰æœ€å° `id` çš„å”¯ä¸€ç”µå­é‚®ä»¶ã€‚

ï¼ˆå¯¹äº SQL ç”¨æˆ·ï¼Œè¯·æ³¨æ„ä½ åº”è¯¥ç¼–å†™ä¸€ä¸ª `DELETE` è¯­å¥è€Œä¸æ˜¯ `SELECT` è¯­å¥ã€‚ï¼‰

ï¼ˆå¯¹äº Pandas ç”¨æˆ·ï¼Œè¯·æ³¨æ„ä½ åº”è¯¥ç›´æ¥ä¿®æ”¹ `Person` è¡¨ã€‚ï¼‰

è¿è¡Œè„šæœ¬åï¼Œæ˜¾ç¤ºçš„ç­”æ¡ˆæ˜¯ `Person` è¡¨ã€‚é©±åŠ¨ç¨‹åºå°†é¦–å…ˆç¼–è¯‘å¹¶è¿è¡Œæ‚¨çš„ä»£ç ç‰‡æ®µï¼Œç„¶åå†æ˜¾ç¤º `Person` è¡¨ã€‚`Person` è¡¨çš„æœ€ç»ˆé¡ºåº **æ— å…³ç´§è¦** ã€‚

è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1:**

```
è¾“å…¥: 
Person è¡¨:
+----+------------------+
| id | email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
| 3  | john@example.com |
+----+------------------+
è¾“å‡º: 
+----+------------------+
| id | email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
+----+------------------+
è§£é‡Š: john@example.comé‡å¤ä¸¤æ¬¡ã€‚æˆ‘ä»¬ä¿ç•™æœ€å°çš„Id = 1ã€‚
```

# æ€è·¯

æœ¬é¢˜ä¸­ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ é™¤æ“ä½œã€‚å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼š

1ã€é¦–å…ˆæŒ‰ç…§é¢˜ç›®æ¡ä»¶æŸ¥å‡ºç›¸åº”è®°å½•ï¼Œå¯ä»¥ä½¿ç”¨è‡ªè¿æ¥æ–¹å¼æŸ¥è¯¢

2ã€ä½¿ç”¨ç¬¬ä¸€æ­¥ä¸­çš„æŸ¥è¯¢æ¡ä»¶ï¼Œåšdeleteæ“ä½œã€‚



è¿™ç§DELETEæ–¹å¼å¾ˆé™Œç”Ÿï¼Œç«Ÿç„¶å’ŒSELETEçš„å†™æ³•ç±»ä¼¼ã€‚å®ƒæ¶‰åŠåˆ°t1å’Œt2ä¸¤å¼ è¡¨ï¼ŒDELETE t1è¡¨ç¤ºè¦åˆ é™¤t1çš„ä¸€äº›è®°å½•ï¼Œå…·ä½“åˆ å“ªäº›ï¼Œå°±çœ‹WHEREæ¡ä»¶ï¼Œæ»¡è¶³å°±åˆ ï¼›

è¿™é‡Œåˆ çš„æ˜¯t1è¡¨ä¸­ï¼Œè·Ÿt2åŒ¹é…ä¸ä¸Šçš„é‚£äº›è®°å½•ã€‚

æ‰€ä»¥ï¼Œå®˜æ–¹sqlä¸­ï¼ŒDELETE p1å°±è¡¨ç¤ºä»p1è¡¨ä¸­åˆ é™¤æ»¡è¶³WHEREæ¡ä»¶çš„è®°å½•ã€‚

2ã€p1.Id > p2.Id

ç»§ç»­ä¹‹å‰ï¼Œå…ˆç®€å•çœ‹ä¸€ä¸‹è¡¨çš„è¿æ¥è¿‡ç¨‹ï¼Œè¿™ä¸ªææ‡‚äº†ï¼Œç†è§£WHEREæ¡ä»¶å°±ç®€å•äº†ğŸ‘‡

a. ä»é©±åŠ¨è¡¨ï¼ˆå·¦è¡¨ï¼‰å–å‡ºNæ¡è®°å½•ï¼›
b. æ‹¿ç€è¿™Næ¡è®°å½•ï¼Œä¾æ¬¡åˆ°è¢«é©±åŠ¨è¡¨ï¼ˆå³è¡¨ï¼‰æŸ¥æ‰¾æ»¡è¶³WHEREæ¡ä»¶çš„è®°å½•ï¼›



```mysql
-- è§£æ³•ä¸€ï¼šDELETE + è‡ªè¿æ¥
delete p1
from Person p1
inner join Person p2
where p1.email = p2.email and p1.id>p2.id;

-- è§£æ³•äºŒï¼šDELETE + å­æŸ¥è¯¢
DELETE FROM Person
WHERE Id NOT IN (   -- åˆ é™¤ä¸åœ¨æŸ¥è¯¢ç»“æœä¸­çš„å€¼
    SELECT id FROM
   (
       SELECT MIN(Id) AS Id -- æ’é™¤Emailç›¸åŒæ—¶ä¸­Idè¾ƒå¤§çš„è¡Œ
       FROM Person
       GROUP BY Email
   ) AS temp    -- æ­¤å¤„éœ€ä½¿ç”¨ä¸´æ—¶è¡¨ï¼Œå¦åˆ™ä¼šå‘ç”ŸæŠ¥é”™
)
```



## æœ¬é¢˜è¦ç‚¹ 

1. **deleteè¯­æ³•å¦‚ä½•ä½œç”¨äºè”ç»“è¡¨** 2. **inner joinçš„åŸç†**

1. deleteè¯­æ³•

æœ€åŸå§‹çš„deleteè¯­å¥

```mysql
delete from table1 where table1.id = 1;
```

å¦‚æœéœ€è¦å…³è”å…¶ä»–è¡¨è¿›è¡Œåˆ é™¤

```mysql
delete table1 
from table1 inner join table2 on table1.id = table2.id 
where table2.type = 'something' and table1.id = 'idnums';
```


